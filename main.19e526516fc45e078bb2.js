!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){var r=n(1),i=n(2);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],i=0;i<e.length;i++){var o=e[i],c=t.base?o[0]+t.base:o[0],l=n[c]||0,u="".concat(c," ").concat(l);n[c]=l+1;var h=a(u),p={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(s[h].references++,s[h].updater(p)):s.push({identifier:u,updater:m(p,t),references:1}),r.push(u)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var s=o(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var u,h=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function p(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=h(t,i);else{var o=document.createTextNode(i),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function f(e,t,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var d=null,y=0;function m(e,t){var n,r,i;if(t.singleton){var o=y++;n=d||(d=l(t)),r=p.bind(null,n,o,!1),i=p.bind(null,n,o,!0)}else n=l(t),r=f.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=a(n[r]);s[i].references--}for(var o=c(e,t),l=0;l<n.length;l++){var u=a(n[l]);0===s[u].references&&(s[u].updater(),s.splice(u,1))}n=o}}}},function(e,t,n){(t=n(3)(!1)).push([e.i,"body{background-color:#000;display:flex;flex-direction:column;align-items:center;width:100vw;height:100vh;margin:0 0}canvas{background:#000;margin-top:30px}",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(s=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),o=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(o).concat([i]).join("\n")}var s,a,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";n.r(t);n(0);var r,i,o=window.devicePixelRatio||1;r=document.querySelector("#canvas"),i=r.getContext("2d");var s=100,a=34,c=window.innerWidth/s,l=c*o,u=1.2*c*o,h=c*o;r.style.cssText="width: ".concat(c*s,"; height: ").concat(1.2*c*a),r.width=l*s,r.height=u*a,i.font="normal ".concat(h,"px ").concat("Menlo"),i.textAlign="center",i.textBaseline="middle";function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function d(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}const y=(e,t)=>{if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");t={pascalCase:!1,...t};return 0===(e=Array.isArray(e)?e.map(e=>e.trim()).filter(e=>e.length).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toLocaleUpperCase():e.toLocaleLowerCase():(e!==e.toLocaleLowerCase()&&(e=(e=>{let t=!1,n=!1,r=!1;for(let i=0;i<e.length;i++){const o=e[i];t&&/[\p{Lu}]/u.test(o)?(e=e.slice(0,i)+"-"+e.slice(i),t=!1,r=n,n=!0,i++):n&&r&&/[\p{Ll}]/u.test(o)?(e=e.slice(0,i-1)+"-"+e.slice(i-1),r=n,n=!1,t=!0):(t=o.toLocaleLowerCase()===o&&o.toLocaleUpperCase()!==o,r=n,n=o.toLocaleUpperCase()===o&&o.toLocaleLowerCase()!==o)}return e})(e)),e=e.replace(/^[_.\- ]+/,"").toLocaleLowerCase().replace(/[_.\- ]+([\p{Alpha}\p{N}_]|$)/gu,(e,t)=>t.toLocaleUpperCase()).replace(/\d+([\p{Alpha}\p{N}_]|$)/gu,e=>e.toLocaleUpperCase()),n=e,t.pascalCase?n.charAt(0).toLocaleUpperCase()+n.slice(1):n);var n};var m=y,g=y;m.default=g;class v{constructor(e){p(this,"component",void 0),this.component=e}get ecs(){return this.component.ecs}get descriptor(){return{enumerable:!0,get:()=>this.get(),set:e=>this.set(e)}}get(){}set(e){}serialize(){}onDestroyed(){}cleanupReference(e){}}class b extends v{constructor(...e){super(...e),p(this,"value",null)}set(e){this.value=e}get(){return this.value}serialize(){return this.value}}class w extends v{constructor(...e){super(...e),p(this,"id",void 0)}set(e){return!this.id||e&&e.id===this.id&&e===this.id||this.ecs.entities.removeRef(this.id,this),e&&e.id?(this.ecs.entities.addRef(e.id,this),void(this.id=e.id)):"string"==typeof e?(this.ecs.entities.addRef(e,this),void(this.id=e)):void(this.id=void 0)}get(){return this.id&&this.component.ecs.getEntity(this.id)}serialize(){return this.id}onDestroyed(){this.id&&this.ecs.entities.removeRef(this.id,this)}cleanupReference(e){this.id===e.id?this.id=void 0:console.warn(`Property in unclean state. A reference to an entity "${e.id}" was never cleaned up.`)}}class M extends v{constructor(e){super(e),p(this,"proxy",[]),this.proxy=new Proxy([],{get:(e,t,n)=>Reflect.get(e,t,n),set:(e,t,n,r)=>{if(isNaN(t))return Reflect.set(e,t,n,r);const i=Reflect.get(e,t,r);return"string"==typeof n&&(n=this.ecs.entities.get(n)),i&&i!=n&&this.ecs.entities.removeRef(n,this),n&&n.id?(this.ecs.entities.addRef(n.id,this),Reflect.set(e,t,n,r)):Reflect.set(e,t,n,r)},deleteProperty:(e,t)=>{if(isNaN(t))return Reflect.deleteProperty(e,t);const n=Reflect.get(e,t);return this.ecs.entities.removeRef(n,this),Reflect.deleteProperty(e,t)}})}set(e=[]){const t=Math.max(e.length,this.proxy.length);for(let n=0;n<t;n++)n in e?this.proxy[n]=e[n]:delete this.proxy[n];this.proxy.length=e.length}get(){return this.proxy}serialize(){return this.proxy.map(e=>e.id)}onDestroyed(){this.set([])}cleanupReference(e){this.set(this.proxy.filter(t=>t.id!==e.id))}}class E{static create(e,t){switch(t){case"<Entity>":return new w(e);case"<EntityArray>":return new M(e);default:return new b(e)}}}class C{static get type(){return this.name}get entity(){return f(this,O)}get ecs(){return f(this,j)}get type(){return this.constructor.name}get isAttached(){return Boolean(this.entity)}get isDestroyed(){return f(this,A)}get allowMultiple(){return this.constructor.allowMultiple}get keyProperty(){return this.constructor.keyProperty}get properties(){const e={};for(const[t,n]of Object.entries(f(this,_)))e[t]=n.get();return e}get key(){return this[this.keyProperty]}constructor(e,t={}){O.set(this,{writable:!0,value:null}),j.set(this,{writable:!0,value:null}),_.set(this,{writable:!0,value:{}}),A.set(this,{writable:!0,value:!1}),d(this,j,e),this._defineProxies(t)}serialize(){return Object.entries(f(this,_)).reduce((e,[t,n])=>({...e,[t]:n.serialize()}),{})}_onAttached(e){d(this,O,e),this.ecs.queries.onComponentAdded(e,this),this.onAttached()}_onDetached(){if(this.isAttached){this.onDetached();const e=f(this,O);d(this,O,null),this.ecs.queries.onComponentRemoved(e,this)}}_onDestroyed(){d(this,A,!0),this.onDestroyed();for(const e of Object.values(f(this,_)))e.onDestroyed()}onAttached(){}onDetached(){}onDestroyed(){}remove(e=!0){this.isAttached&&this.entity.remove(this),e&&this._onDestroyed()}destroy(){this.remove(!0)}_onEvent(e){this.onEvent(e);const t=m("on "+e.name);"function"==typeof this[t]&&this[t](e)}onEvent(e){}_defaultPropertyValue(e){const t=this.constructor.properties[e];return"<EntityArray>"===t?[]:"<Entity>"!==t?t:void 0}_defineProxies(e){for(const t in this.constructor.properties){const n=e.hasOwnProperty(t)?e[t]:this._defaultPropertyValue(t),r=E.create(this,this.constructor.properties[t]);f(this,_)[t]=r,Object.defineProperty(this,t,r.descriptor),r.set(n)}}}var O=new WeakMap,j=new WeakMap,_=new WeakMap,A=new WeakMap;p(C,"allowMultiple",!1),p(C,"keyProperty",null),p(C,"properties",{});class k{constructor(e){P.set(this,{writable:!0,value:new Map}),x.set(this,{writable:!0,value:new Map}),R.set(this,{writable:!0,value:null}),d(this,R,e)}register(e){f(this,x).set(e.name,e),f(this,P).set(e.name,m(e.name))}getAccessor(e){if(f(this,P).has(e))return f(this,P).get(e);f(this,P).set(e,m(e))}get(e){const t=this._getType(e);return t?f(this,x).get(t):(console.warn(`Cannot get component definition for type or class ${e} since it is neither a Component class or type (string)`),null)}create(e,t={}){const n=this.get(e);if(n)return new n(f(this,R),t);console.warn(`Could not create component definition for ${e} since it is not registered`)}_getType(e){return"string"==typeof e?e:e instanceof C?e.type:e.prototype instanceof C?e.name:null}}var P=new WeakMap,x=new WeakMap,R=new WeakMap,D=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===S}(e)}(e)};var S="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function T(e,t){return!1!==t.clone&&t.isMergeableObject(e)?q((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function $(e,t,n){return e.concat(t).map((function(e){return T(e,n)}))}function z(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function L(e,t){try{return t in e}catch(e){return!1}}function W(e,t,n){var r={};return n.isMergeableObject(e)&&z(e).forEach((function(t){r[t]=T(e[t],n)})),z(t).forEach((function(i){(function(e,t){return L(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(L(e,i)&&n.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return q;var n=t.customMerge(e);return"function"==typeof n?n:q}(i,n)(e[i],t[i],n):r[i]=T(t[i],n))})),r}function q(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||$,n.isMergeableObject=n.isMergeableObject||D,n.cloneUnlessOtherwiseSpecified=T;var r=Array.isArray(t);return r===Array.isArray(e)?r?n.arrayMerge(e,t,n):W(e,t,n):T(t,n)}q.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return q(e,n,t)}),{})};var N=q;class U{get type(){return this.componentDef.type}constructor(e,t={},n=!0){this.componentDef=e,this.properties=t,this.overwrite=n}applyToEntity(e,t={}){if(!this.componentDef.allowMultiple&&e.has(this.componentDef)){if(!this.overwrite)return void console.log(`Ignoring prefab component "${this.type}" since the entity "${e.id}" already has one.`);e.remove(this.componentDef)}const n=N(this.properties,t);e.add(this.componentDef,n)}}class I{constructor(e,t){p(this,"name",""),p(this,"inherit",[]),p(this,"components",[]),this.ecs=e,this.name=t}addComponent(e){this.components.push(e)}applyToEntity(e,t={}){this.inherit.forEach(n=>{n.applyToEntity(e,t)});const n={};return this.components.forEach((r,i)=>{const o=r.componentDef,s=this.ecs.components.getAccessor(o.type);let a={};if(o.allowMultiple)if(o.keyProperty){const e=r.properties[o.keyProperty];t[s]&&t[s][e]&&(a=t[s][e])}else n[s]||(n[s]=0),t[s]&&t[s][n[s]]&&(a=t[s][n[s]]),n[s]++;else a=t[s];r.applyToEntity(e,a)}),e}}class B{constructor(e){G.set(this,{writable:!0,value:{}}),F.set(this,{writable:!0,value:null}),d(this,F,e)}deserialize(e){const t=this.get(e.name);if(t)return t;const n=new I(f(this,F),e.name);let r;r=Array.isArray(e.inherit)?e.inherit:"string"==typeof e.inherit?[e.inherit]:[],n.inherit=r.map(t=>{const n=this.get(t);return n||(console.warn(`Prefab "${e.name}" cannot inherit from Prefab "${t}" because is not registered yet! Prefabs must be registered in the right order.`),t)});const i=e.components||[];for(const t of i)if("string"==typeof t||t.prototype instanceof C){const e=f(this,F).components.get(t);e&&n.addComponent(new U(e))}else if("object"==typeof t){const e=t.type,r=f(this,F).components.get(e);r&&n.addComponent(new U(r,t.properties,t.overwrite))}else console.warn(`Unrecognized component reference "${t}" in prefab "${e.name}". Ensure the component is registered before the prefab.`);return this.register(n),n}register(e){f(this,G)[e.name]=e}get(e){const t=B._getName(e);return f(this,G)[t]}create(e,t={}){const n=this.get(e);if(!n)return void console.warn(`Could not instantiate prefab for ${e} since it is not registered`);const r=f(this,F).createEntity();return n.applyToEntity(r,t),r}static _getName(e){return"string"==typeof e?e:e instanceof I||e.prototype instanceof I?e.name:null}}var G=new WeakMap,F=new WeakMap;class H{get prevented(){return f(this,J)}get handled(){return f(this,Q)}constructor(e,t={}){p(this,"data",{}),J.set(this,{writable:!0,value:!1}),Q.set(this,{writable:!0,value:!1}),this.name=e,this.data=t}is(e){return this.name===e}handle(){d(this,Q,!0),d(this,J,!0)}prevent(){d(this,J,!0)}}var J=new WeakMap,Q=new WeakMap;class V{get ecs(){return f(this,Y)}get components(){return f(this,X)}get isDestroyed(){return f(this,Z)}constructor(e,t=null){K.set(this,{writable:!0,value:null}),X.set(this,{writable:!0,value:{}}),Y.set(this,{writable:!0,value:null}),Z.set(this,{writable:!0,value:!1}),d(this,Y,e),d(this,K,t||e.generateId()),Object.defineProperty(this,"id",{value:f(this,K),enumerable:!0,writable:!1})}has(e,t=null){const n=this.ecs.components._getType(e),r=this.ecs.components.getAccessor(n),i=this.hasOwnProperty(r);return i&&t?this[r].hasOwnProperty(t):i}get(e,t=null){const n=this.ecs.components._getType(e),r=this[this.ecs.components.getAccessor(n)];return r&&t?r[t]:r}destroy(){d(this,Z,!0);for(const e of Object.values(this.components))if(e instanceof C)e.destroy();else for(const t of Object.values(e))t.destroy();this.ecs.entities.onEntityDestroyed(this)}add(e,t={}){const n=this.ecs.components.create(e,t);return n?this.attach(n):(console.warn(`"${e}" component cannot be added, since it is not registered.`),!1)}attach(e){const t=this.ecs.components.getAccessor(e.type);return e.allowMultiple?e.keyProperty?e.key?(this.components[t]||(this.components[t]={},Object.defineProperty(this,t,{configurable:!0,enumerable:!0,get(){return this.components[t]}})),this.components[t][e.key]=e,e._onAttached(this),this.ecs.queries.onComponentAdded(this,e),!0):(console.warn(`"${e.type}" component has a falsy key of "${e.key}". The keyProperty is set to "${e.keyProperty}".`),!1):(this.components[t]||(this.components[t]=[],Object.defineProperty(this,t,{configurable:!0,enumerable:!0,get(){return this.components[t]}})),this.components[t].push(e),e._onAttached(this),this.ecs.queries.onComponentAdded(this),!0):this.has(e.type)?(console.warn(`"${e.type}" component has allowMultiple set to ${e.allowMultiple}. Trying to add a "${e.type}" component to an entity which already has one.`),!1):(this.components[t]=e,Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get(){return this.components[t]}}),e._onAttached(this),this.ecs.queries.onComponentAdded(this),!0)}owns(e){return e.entity===this}remove(e,t=null){const n=e instanceof C;t=n?e.key:t;const r=this.ecs.components.get(e),i=this.ecs.components.getAccessor(r.type);if(r.allowMultiple){if(!r.keyProperty){if(!n){for(const e of this.components[i])e._onDetached();return delete this[i],delete this.components[i],this.ecs.queries.onComponentRemoved(this),!0}{const t=this.components[i];if(!t)return void console.warn(`Trying to remove a "${r.type}" component from an entity, but it wasn't found.`);const n=t.indexOf(e);if(n>-1)return t.splice(n,1),e._onDetached(),0===t.length&&(delete this[i],delete this.components[i]),this.ecs.queries.onComponentRemoved(this),!0}}if(!t)return void console.warn(`Trying to remove a "${r.type}" component which allows multiple without specifying an key.`);const o=this.components[i],s=o[t];return s?(delete o[t],s._onDetached(),Object.keys(o).length<=0&&(delete this[i],delete this.components[i]),this.ecs.queries.onComponentRemoved(this),s):void console.warn(`Trying to remove a "${r.type}" component from an entity at "${t}", but it wasn't found.`)}if(i in this){const e=this.components[i];return delete this[i],delete this.components[i],e._onDetached(),this.ecs.queries.onComponentRemoved(this),e}console.warn(`Trying to remove a "${r.type}" component from an entity, but it wasn't found.`)}serialize(){return Object.entries(this.components).reduce((e,[t,n])=>n instanceof C?{...e,[t]:n.serialize()}:Array.isArray(n)?{...e,[t]:n.map(e=>e.serialize())}:{...e,[t]:Object.entries(n).reduce((e,[t,n])=>({...e,[t]:n.serialize()}),{})},{id:this.id})}fireEvent(e,t){const n=new H(e,t);for(const e of Object.values(this.components))if(e instanceof C){if(e._onEvent(n),n.prevented)return n}else for(const t of Object.values(e))if(t._onEvent(n),n.prevented)return n;return n}}var K=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap;class ee{constructor(e){te.set(this,{writable:!0,value:new Map}),ne.set(this,{writable:!0,value:null}),re.set(this,{writable:!0,value:new Map}),d(this,ne,e)}get all(){return f(this,te).values()}register(e){return f(this,te).set(e.id,e),e}get(e){return f(this,te).get(e)}createOrGetById(e){const t=this.get(e);return t||this.create(e)}create(e){const t=new V(f(this,ne),e);return this.register(t),f(this,ne).queries.onEntityCreated(t),t}destroy(e){e.destroy()}onEntityDestroyed(e){this.cleanupRefs(e),f(this,te).delete(e.id),f(this,ne).queries.onEntityDestroyed(e)}cleanupRefs(e){const t=f(this,re).get(e.id);if(t){for(const n of t)n.cleanupReference(e);delete f(this,re)[e.id]}}addRef(e,t){f(this,re).has(e)?f(this,re).get(e).add(t):f(this,re).set(e,new Set([t]))}removeRef(e,t){f(this,re).has(e)&&f(this,re).get(e).delete(t)}serialize(){const e=[];return f(this,te).forEach(t=>{e.push(t.serialize())}),e}deserialize(e){for(const t of e.entities)this.createOrGetById(t.id);for(const t of e.entities)this.deserializeEntity(t)}deserializeEntity(e){const{id:t,...n}=e,r=this.createOrGetById(t);Object.entries(n).forEach(([e,t])=>{const n=m(e,{pascalCase:!0}),i=f(this,ne).components.get(n);i.allowMultiple?Object.values(t).forEach(e=>{r.add(i,e)}):r.add(i,t)})}}var te=new WeakMap,ne=new WeakMap,re=new WeakMap;class ie{constructor(e,t={}){oe.set(this,{writable:!0,value:void 0}),se.set(this,{writable:!0,value:void 0}),ae.set(this,{writable:!0,value:new Set}),d(this,oe,e),d(this,se,N({any:[],all:[],none:[]},t)),this.bustCache()}isMatch(e){const t=!f(this,se).any.length||f(this,se).any.some(t=>e.has(t)),n=f(this,se).all.every(t=>e.has(t)),r=!f(this,se).none.some(t=>e.has(t));return t&&n&&r}candidate(e){return this.isMatch(e)?(f(this,ae).add(e),!0):(f(this,ae).delete(e),!1)}_onEntityCreated(e){this.candidate(e)}_onComponentAdded(e){this.candidate(e)}_onComponentRemoved(e){this.candidate(e)}_onEntityDestroyed(e){f(this,ae).delete(e)}bustCache(){f(this,ae).clear();for(const e of f(this,oe).entities.all)this.candidate(e);return f(this,ae)}get(){return f(this,ae)}}var oe=new WeakMap,se=new WeakMap,ae=new WeakMap;class ce{constructor(e){le.set(this,{writable:!0,value:void 0}),ue.set(this,{writable:!0,value:[]}),d(this,le,e)}create(e){const t=new ie(f(this,le),e);return f(this,ue).push(t),t}onComponentAdded(e){f(this,ue).forEach(t=>t._onComponentAdded(e))}onComponentRemoved(e){f(this,ue).forEach(t=>t._onComponentRemoved(e))}onEntityCreated(e){f(this,ue).forEach(t=>t._onEntityCreated(e))}onEntityDestroyed(e){f(this,ue).forEach(t=>t._onEntityDestroyed(e))}}var le=new WeakMap,ue=new WeakMap;function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ge(e);if(t){var i=ge(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return me(this,n)}}function me(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}document.addEventListener("keydown",(function(e){return console.log(e.key)}));var be=new class{constructor(){this.idGenerator=()=>((e=21)=>{let t="",n=e;for(;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t})(),this.components=new k(this),this.prefabs=new B(this),this.entities=new ee(this),this.queries=new ce(this)}generateId(){return this.idGenerator()}createEntity(){return this.entities.create()}createPrefab(e,t={}){return this.prefabs.create(e,t)}destroyEntity(e){return this.entities.destroy(e)}registerPrefab(e){this.prefabs.deserialize(e)}registerComponent(e){this.components.register(e)}getEntity(e){return this.entities.get(e)}createComponent(e,t){return this.components.create(e,t)}createQuery(e){return this.queries.create(e)}serialize(){return{entities:this.entities.serialize()}}deserialize(e){return e.id?this.entities.deserializeEntity(e):this.entities.deserialize(e)}},we=function(e){fe(n,e);var t=ye(n);function n(){return pe(this,n),t.apply(this,arguments)}return n}(C);ve(we,"properties",{x:0,y:0});var Me=function(e){fe(n,e);var t=ye(n);function n(){return pe(this,n),t.apply(this,arguments)}return n}(C);ve(Me,"properties",{x:0,y:0});var Ee=function(e){fe(n,e);var t=ye(n);function n(){return pe(this,n),t.apply(this,arguments)}return n}(C);be.registerComponent(we),be.registerComponent(Me),be.registerComponent(Ee);var Ce=be.createEntity();Ce.add(we,{x:4,y:10}),Ce.add(Me,{x:1,y:.25});be.createQuery({all:[we,Me],none:[Ee]});var Oe=be.serialize();console.log(Oe)}]);
//# sourceMappingURL=main.19e526516fc45e078bb2.js.map